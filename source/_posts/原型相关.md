---
title: 原型相关
date: 2019-04-08 10:09:37
tags: JavaScript
categories: JavaScript知识
---

# 前言

看了很多其他人写的文章，从中挑选出几篇很有帮助的文章：

- [彻底理解JavaScript原型](https://www.cnblogs.com/wilber2013/p/4924309.html)
- [JavaScript深入之从原型到原型链](<https://github.com/mqyqingfeng/Blog/issues/2>)
- [详解JS原型链与继承](<http://louiszhai.github.io/2015/12/15/prototypeChain/>)
- [JavaScript 世界万物诞生记](<https://zhuanlan.zhihu.com/p/22989691>)

# 三个要点

- 所有对象都有[[prototype]]属性（通过\_\_proto\_\_访问)
- 只有函数对象才有prototype属性（可能有例外情况）
- 所有原型对象都有constructor属性

# 例子

与其说一些很是抽象的概念，还不如实例分析来的实在。例：

```js
function Person(name,age) {
  this.name = name;
  this.age = age;
}
var person1 = new Person()
```

![构造函数创建实例](new.png)

# new

构造函数Person通过new创建实例的时候，做了什么事情？

```js
var obj = new Object(),

Constructor = [].shift.call(arguments);

obj.__proto__ = Constructor.prototype;

var res = Constructor.apply(obj, arguments);

return typeof res === 'object' ? res : obj;
```

# 原型

从上面的new操作中可以看出，构造函数创建实例的时候，prototype属性值被赋值给实例对象的\_\_proto\_\_属性，即：

```js
person1.__proto__ === Person.prototype
```

![原型](prototype.png)

从中可以看出，构造函数通过prototype属性可以找到实例的原型，实例可以通过\_\_proto\_\_属性找到它的原型，那么，疑问产生了？构造函数和实例都有相应的属性可以找到原型，原型可以反找回他们吗？

![constructor](constructor.png)

原型对象可以根据constructor属性找到相应的构造函数，却没有相关属性可以找到实例，因为一个构造函数可以创建多个实例，而所有实例对应的是同一个原型对象。

再深入的思考下，构造函数会有原型吗？原型的原型又是什么？以此类推......

所有的函数（包括Function，Object）的原型都是"Function.prototype"，所有对象的原型都将追溯到"Object {}"对象，直到链条的最终端null，如下图

![原型](proto.png)

相互关联的原型组成的链状结构就是原型链了，实例对象就是通过这条链寻找自身不具有的属性，如果直到链条的最终端null都还未找到，则返回undefined。

# 注意点

```js
person1.constructor === Person // true，并不是person1具有constructor属性，而是通过原型链在它的原型上找到的属性。可以使用方法hasOwnProperty判断，指示对象自身属性中是否具有指定的属性。
person1.hasOwnProperty("constructor") // false
```

